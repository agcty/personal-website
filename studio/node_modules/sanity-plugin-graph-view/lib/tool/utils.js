"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.sizeOf = sizeOf;
exports.loadImage = loadImage;
exports.sortBy = sortBy;
exports.truncate = truncate;

var _slicedToArray2 = _interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));

var _typeof2 = _interopRequireDefault(require("@babel/runtime/helpers/typeof"));

function sizeOf(value) {
  if (value == null) {
    return 0;
  }

  if ((0, _typeof2["default"])(value) === 'object') {
    return Object.entries(value).reduce(function (total, _ref) {
      var _ref2 = (0, _slicedToArray2["default"])(_ref, 2),
          k = _ref2[0],
          v = _ref2[1];

      return total + sizeOf(k) + sizeOf(v);
    }, 0);
  }

  if (Array.isArray(value)) {
    return Object.entries(value).reduce(function (total, v) {
      return total + sizeOf(v);
    }, 0);
  }

  if (typeof value === 'string') {
    return value.length;
  }

  return 1;
}

function loadImage(url, w, h) {
  return new Promise(function (resolve) {
    var img = new Image(w, h);

    img.onload = function () {
      resolve(img);
    };

    img.onerror = function (event) {
      console.log('Image error', event);
      resolve(null);
    };

    img.src = url;
  });
}

function sortBy(array, f) {
  return array.sort(function (a, b) {
    var va = f(a);
    var vb = f(b);
    return va < vb ? -1 : va > vb ? 1 : 0;
  });
}

function truncate(s, limit) {
  if (s.length > limit) {
    s = s.substring(0, limit) + 'â€¦';
  }

  return s;
}